GCCcore/11.3.0
zlib/1.2.12-GCCcore-11.3.0
binutils/2.38-GCCcore-11.3.0
GCC/11.3.0
numactl/2.0.14-GCCcore-11.3.0
XZ/5.2.5-GCCcore-11.3.0
libxml2/2.9.13-GCCcore-11.3.0
libpciaccess/0.16-GCCcore-11.3.0
hwloc/2.7.1-GCCcore-11.3.0
OpenSSL/1.1
libevent/2.1.12-GCCcore-11.3.0
UCX/1.12.1-GCCcore-11.3.0
libfabric/1.15.1-GCCcore-11.3.0
PMIx/4.1.2-GCCcore-11.3.0
UCC/1.0.0-GCCcore-11.3.0
OpenMPI/4.1.4-GCC-11.3.0
OpenBLAS/0.3.20-GCC-11.3.0
FlexiBLAS/3.2.0-GCC-11.3.0
FFTW/3.3.10-GCC-11.3.0
gompi/2022a
FFTW.MPI/3.3.10-gompi-2022a
ScaLAPACK/2.2.0-gompi-2022a-fb
foss/2022a
CUDA/11.7.0
bzip2/1.0.8-GCCcore-11.3.0
ncurses/6.3-GCCcore-11.3.0
libreadline/8.1.2-GCCcore-11.3.0
ncurses/6.3-GCCcore-11.3.0
Tcl/8.6.12-GCCcore-11.3.0
SQLite/3.38.3-GCCcore-11.3.0
GMP/6.2.1-GCCcore-11.3.0
libffi/3.4.2-GCCcore-11.3.0
Python/3.10.4-GCCcore-11.3.0
pybind11/2.9.2-GCCcore-11.3.0
SciPy-bundle/2022.05-foss-2022a
libyaml/0.2.5-GCCcore-11.3.0
PyYAML/6.0-GCCcore-11.3.0
Ninja/1.10.2-GCCcore-11.3.0
protobuf/3.19.4-GCCcore-11.3.0
protobuf-python/3.19.4-GCCcore-11.3.0
MPFR/4.1.0-GCCcore-11.3.0
NASM/2.15.05-GCCcore-11.3.0
x264/20220620-GCCcore-11.3.0
LAME/3.100-GCCcore-11.3.0
x265/3.5-GCCcore-11.3.0
expat/2.4.8-GCCcore-11.3.0
libpng/1.6.37-GCCcore-11.3.0
Brotli/1.0.9-GCCcore-11.3.0
freetype/2.12.1-GCCcore-11.3.0
util-linux/2.38-GCCcore-11.3.0
fontconfig/2.14.0-GCCcore-11.3.0
freetype/2.12.1-GCCcore-11.3.0
xorg-macros/1.19.3-GCCcore-11.3.0
X11/20220504-GCCcore-11.3.0
freetype/2.12.1-GCCcore-11.3.0
fontconfig/2.14.0-GCCcore-11.3.0
FriBidi/1.0.12-GCCcore-11.3.0
FFmpeg/4.4.2-GCCcore-11.3.0
libjpeg-turbo/2.1.3-GCCcore-11.3.0
jbigkit/2.1-GCCcore-11.3.0
gzip/1.12-GCCcore-11.3.0
lz4/1.9.3-GCCcore-11.3.0
zstd/1.5.2-GCCcore-11.3.0
libdeflate/1.10-GCCcore-11.3.0
LibTIFF/4.3.0-GCCcore-11.3.0
Pillow/9.1.1-GCCcore-11.3.0
cuDNN/8.4.1.50-CUDA-11.7.0
GDRCopy/2.3-GCCcore-11.3.0
UCX-CUDA/1.12.1-GCCcore-11.3.0-CUDA-11.7.0
magma/2.6.2-foss-2022a-CUDA-11.7.0
NCCL/2.12.12-GCCcore-11.3.0-CUDA-11.7.0
expecttest/0.1.3-GCCcore-11.3.0
PyTorch/1.12.1-foss-2022a-CUDA-11.7.0
tqdm/4.64.0-GCCcore-11.3.0
Transformers/4.24.0-foss-2022a-CUDA-11.7.0
ICU/71.1-GCCcore-11.3.0
Boost/1.79.0-GCC-11.3.0
snappy/1.1.9-GCCcore-11.3.0
RapidJSON/1.1.0-GCCcore-11.3.0
RE2/2022-06-01-GCCcore-11.3.0
utf8proc/2.7.0-GCCcore-11.3.0
Arrow/8.0.0-foss-2022a
Tk/8.6.12-GCCcore-11.3.0
Tkinter/3.10.4-GCCcore-11.3.0
Qhull/2020.2-GCCcore-11.3.0
matplotlib/3.5.2-foss-2022a
polars/0.17.12-foss-2022a
poetry/1.2.2-GCCcore-11.3.0
aiohttp/3.8.3-GCCcore-11.3.0
BeautifulSoup/4.10.0-GCCcore-11.3.0
deepdiff/5.8.1-GCCcore-11.3.0
tensorboardX/2.5.1-foss-2022a
PyTorch-Lightning/1.9.3-foss-2022a-CUDA-11.7.0
Hydra/1.3.2-GCCcore-11.3.0
scikit-learn/1.1.2-foss-2022a
sklearn-pandas/2.2.0-foss-2022a
/rds/projects/g/gokhalkm-optimal/DataforCharles
/rds/projects/g/gokhalkm-optimal/DataforCharles
dumb
icelake
/rds/homes/g/gaddcz/Projects/CPRD/virtual-env-icelake
Build dataset from CPRD.db database from Version 3 of DeXTER output
INFO:root:Building Polars datasets and saving to /rds/projects/g/gokhalkm-optimal/OPTIMAL_MASTER_DATASET/data/FoundationalModel/PreTrain/
INFO:root:Chunking by unique practice ID with ["COUNTRY = 'E'"] practice inclusion conditions
INFO:root:Creating train/test/val splits using practice_ids
INFO:root:

Collecting meta information from database. This will be used for tokenization and (optionally) standardisation.
INFO:root:	 Static meta information
INFO:root:	 Diagnosis meta information
INFO:root:	 Measurements meta information
Added path '/rds/homes/g/gaddcz/Projects/CPRD/virtual-env-icelake/lib/python3.10/site-packages' at start of search paths.
Using device: cuda.
is_decoder: true
data:
  batch_size: 64
  unk_freq_threshold: 0.0
  min_workers: 20
  global_diagnoses: false
  path_to_db: /rds/projects/g/gokhalkm-optimal/OPTIMAL_MASTER_DATASET/data/FoundationalModel/
  path_to_ds: /rds/projects/g/gokhalkm-optimal/OPTIMAL_MASTER_DATASET/data/FoundationalModel/PreTrain/
  meta_information_path: /rds/projects/g/gokhalkm-optimal/OPTIMAL_MASTER_DATASET/data/FoundationalModel/PreTrain/meta_information.pickle
experiment:
  project_name: SurvStreamGPT_${head.SurvLayer}
  run_id: PreTrain_${head.SurvLayer}_129M_${experiment.seed}
  train: true
  test: true
  verbose: true
  seed: 1337
  log: true
  log_dir: /rds/projects/s/subramaa-mum-predict/CharlesGadd_Oxford/FoundationModelOutput/
  ckpt_dir: /rds/projects/s/subramaa-mum-predict/CharlesGadd_Oxford/FoundationModelOutput/checkpoints/
optim:
  num_epochs: 1
  learning_rate: 0.0001
  scheduler: CAWarmRestarts
  scheduler_periods: 5000
  scheduler_warmup: true
  lr_cosine_decay_period: 10000000.0
  val_check_interval: 1000
  early_stop: false
  early_stop_patience: 5
  log_every_n_steps: 20
  limit_val_batches: 0.05
  limit_test_batches: 0.05
transformer:
  block_type: Neo
  block_size: 128
  n_layer: 10
  n_head: 8
  n_embd: 1024
  layer_norm_bias: false
  attention_type: global
  bias: true
  dropout: 0.2
  attention_dropout: 0.2
  resid_dropout: 0.2
head:
  SurvLayer: cr
  surv_weight: 0.5
  tokens_for_univariate_regression: None
  value_weight: 0.5

                                      Measurements:   0%|          | 0/189 [00:00<?, ?it/s]                                      Measurements:   1%|          | 1/189 [00:01<04:42,  1.50s/it]                                      Measurements:   1%|          | 2/189 [00:04<07:40,  2.46s/it]                                      Measurements:   2%|▏         | 3/189 [00:06<06:29,  2.09s/it]                                      Measurements:   2%|▏         | 4/189 [00:09<07:43,  2.50s/it]                                      Measurements:   3%|▎         | 5/189 [00:10<06:21,  2.07s/it]                                      Measurements:   3%|▎         | 6/189 [00:28<22:59,  7.54s/it]                                      Measurements:   4%|▎         | 7/189 [00:30<16:40,  5.50s/it]                                      Measurements:   4%|▍         | 8/189 [00:31<12:53,  4.27s/it]                                      Measurements:   5%|▍         | 9/189 [00:55<31:24, 10.47s/it]                                      Measurements:   5%|▌         | 10/189 [00:58<23:38,  7.92s/it]                                      Measurements:   6%|▌         | 11/189 [00:59<17:45,  5.98s/it]                                      Measurements:   6%|▋         | 12/189 [01:02<15:11,  5.15s/it]                                      Measurements:   7%|▋         | 13/189 [01:06<13:28,  4.59s/it]                                      Measurements:   7%|▋         | 14/189 [01:11<13:36,  4.67s/it]                                      Measurements:   8%|▊         | 15/189 [01:13<11:18,  3.90s/it]                                      Measurements:   8%|▊         | 16/189 [02:02<50:56, 17.67s/it]                                      Measurements:   9%|▉         | 17/189 [02:23<52:59, 18.49s/it]                                      Measurements:  10%|▉         | 18/189 [02:30<43:00, 15.09s/it]                                      Measurements:  10%|█         | 19/189 [02:34<33:30, 11.83s/it]                                      Measurements:  11%|█         | 20/189 [02:37<25:29,  9.05s/it]                                      Measurements:  11%|█         | 21/189 [02:55<32:47, 11.71s/it]                                      Measurements:  12%|█▏        | 22/189 [02:59<26:22,  9.48s/it]                                      Measurements:  12%|█▏        | 23/189 [03:17<33:06, 11.96s/it]                                      Measurements:  13%|█▎        | 24/189 [03:26<30:50, 11.21s/it]                                      Measurements:  13%|█▎        | 25/189 [03:28<22:55,  8.39s/it]                                      Measurements:  14%|█▍        | 26/189 [03:50<34:14, 12.60s/it]                                      Measurements:  14%|█▍        | 27/189 [03:55<27:16, 10.10s/it]                                      Measurements:  15%|█▍        | 28/189 [03:56<20:03,  7.48s/it]                                      Measurements:  15%|█▌        | 29/189 [04:03<19:54,  7.46s/it]                                      Measurements:  16%|█▌        | 30/189 [04:25<31:15, 11.80s/it]                                      Measurements:  16%|█▋        | 31/189 [04:43<35:19, 13.41s/it]                                      Measurements:  17%|█▋        | 32/189 [05:05<42:07, 16.10s/it]                                      Measurements:  17%|█▋        | 33/189 [05:31<49:21, 18.99s/it]                                      Measurements:  18%|█▊        | 34/189 [05:51<50:11, 19.43s/it]                                      Measurements:  19%|█▊        | 35/189 [05:53<36:08, 14.08s/it]                                      Measurements:  19%|█▉        | 36/189 [06:15<41:51, 16.41s/it]                                      Measurements:  20%|█▉        | 37/189 [06:26<37:52, 14.95s/it]                                      Measurements:  20%|██        | 38/189 [06:29<28:35, 11.36s/it]                                      Measurements:  21%|██        | 39/189 [06:45<31:45, 12.71s/it]                                      Measurements:  21%|██        | 40/189 [07:11<41:48, 16.83s/it]                                      Measurements:  22%|██▏       | 41/189 [07:14<30:50, 12.51s/it]                                      Measurements:  22%|██▏       | 42/189 [07:18<24:22,  9.95s/it]                                      Measurements:  23%|██▎       | 43/189 [07:20<18:51,  7.75s/it]                                      Measurements:  23%|██▎       | 44/189 [07:23<14:39,  6.06s/it]                                      Measurements:  24%|██▍       | 45/189 [07:24<11:16,  4.70s/it]                                      Measurements:  24%|██▍       | 46/189 [07:28<10:32,  4.42s/it]                                      Measurements:  25%|██▍       | 47/189 [07:30<09:01,  3.81s/it]                                      Measurements:  25%|██▌       | 48/189 [07:34<08:48,  3.75s/it]                                      Measurements:  26%|██▌       | 49/189 [07:37<08:20,  3.58s/it]                                      Measurements:  26%|██▋       | 50/189 [07:38<06:50,  2.95s/it]                                      Measurements:  27%|██▋       | 51/189 [07:40<05:42,  2.48s/it]                                      Measurements:  28%|██▊       | 52/189 [07:41<04:47,  2.10s/it]                                      Measurements:  28%|██▊       | 53/189 [07:44<05:09,  2.27s/it]                                      Measurements:  29%|██▊       | 54/189 [07:46<04:50,  2.15s/it]                                      Measurements:  29%|██▉       | 55/189 [07:48<04:48,  2.16s/it]                                      Measurements:  30%|██▉       | 56/189 [07:50<04:48,  2.17s/it]                                      Measurements:  30%|███       | 57/189 [07:53<05:11,  2.36s/it]                                      Measurements:  31%|███       | 58/189 [07:55<05:01,  2.30s/it]                                      Measurements:  31%|███       | 59/189 [07:57<04:42,  2.17s/it]                                      Measurements:  32%|███▏      | 60/189 [07:59<04:41,  2.18s/it]                                      Measurements:  32%|███▏      | 61/189 [08:01<04:29,  2.10s/it]                                      Measurements:  33%|███▎      | 62/189 [08:03<04:41,  2.21s/it]                                      Measurements:  33%|███▎      | 63/189 [08:05<04:31,  2.16s/it]                                      Measurements:  34%|███▍      | 64/189 [08:27<16:44,  8.04s/it]                                      Measurements:  34%|███▍      | 65/189 [08:51<26:24, 12.78s/it]                                      Measurements:  35%|███▍      | 66/189 [09:04<26:19, 12.84s/it]                                      Measurements:  35%|███▌      | 67/189 [09:07<19:55,  9.80s/it]                                      Measurements:  36%|███▌      | 68/189 [09:12<17:17,  8.58s/it]                                      Measurements:  37%|███▋      | 69/189 [09:29<21:41, 10.84s/it]                                      Measurements:  37%|███▋      | 70/189 [09:37<20:18, 10.24s/it]                                      Measurements:  38%|███▊      | 71/189 [09:40<15:52,  8.07s/it]                                      Measurements:  38%|███▊      | 72/189 [09:43<12:39,  6.49s/it]                                      Measurements:  39%|███▊      | 73/189 [09:59<17:46,  9.20s/it]                                      Measurements:  39%|███▉      | 74/189 [10:11<19:24, 10.12s/it]                                      Measurements:  40%|███▉      | 75/189 [10:28<23:20, 12.29s/it]                                      Measurements:  40%|████      | 76/189 [10:48<27:01, 14.35s/it]                                      Measurements:  41%|████      | 77/189 [10:54<22:13, 11.91s/it]                                      Measurements:  41%|████▏     | 78/189 [11:01<19:24, 10.49s/it]                                      Measurements:  42%|████▏     | 79/189 [11:15<21:23, 11.67s/it]                                      Measurements:  42%|████▏     | 80/189 [11:23<19:07, 10.53s/it]                                      Measurements:  43%|████▎     | 81/189 [11:45<25:09, 13.97s/it]                                      Measurements:  43%|████▎     | 82/189 [11:52<21:10, 11.87s/it]                                      Measurements:  44%|████▍     | 83/189 [11:57<17:28,  9.89s/it]                                      Measurements:  44%|████▍     | 84/189 [12:04<15:39,  8.95s/it]                                      Measurements:  45%|████▍     | 85/189 [12:11<14:21,  8.29s/it]                                      Measurements:  46%|████▌     | 86/189 [12:16<12:25,  7.24s/it]                                      Measurements:  46%|████▌     | 87/189 [12:37<19:37, 11.54s/it]                                      Measurements:  47%|████▋     | 88/189 [12:40<14:59,  8.91s/it]                                      Measurements:  47%|████▋     | 89/189 [13:00<20:11, 12.12s/it]                                      Measurements:  48%|████▊     | 90/189 [13:03<15:24,  9.34s/it]                                      Measurements:  48%|████▊     | 91/189 [13:15<16:44, 10.25s/it]                                      Measurements:  49%|████▊     | 92/189 [13:17<12:49,  7.93s/it]                                      Measurements:  49%|████▉     | 93/189 [13:29<14:26,  9.03s/it]                                      Measurements:  50%|████▉     | 94/189 [13:47<18:34, 11.73s/it]